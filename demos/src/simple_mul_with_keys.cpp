/**
 * SPOG
 * Copyright (C) 2017-2019 SPOG Authors
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

    
#include <fstream>
#include <iterator>
#include <iomanip>
#include <cuda_runtime_api.h>
#include <NTL/ZZ.h>
#include <NTL/ZZ_pX.h>
#include <NTL/ZZ_pE.h>
#include <time.h>
#include <unistd.h>
#include <iomanip>
#include <cuPoly/settings.h>
#include <cuPoly/arithmetic/polynomial.h>
#include <cuPoly/cuda/sampler.h>
#include <SPOG/fv.h>
#include <cuda_profiler_api.h>

#define BILLION  1000000000L
#define MILLION  1000000L
#define NITERATIONS 1


/**
  simple_mul:

  The intention of this program is to explore the homomorphic multiplication on
  SPOG from the point of view of memory managing.
  
  Here we use a Params object to setup and instantiate a FV object.
 */
 int main(){
  Logger::getInstance()->set_mode(DEBUG);
  cudaProfilerStop();

  FVContext *cipher;
  ZZ q;

  srand(0);
  NTL::SetSeed(to_ZZ(0));

  // Params
  Params p;
  p.nphi = 64;
  p.t = 256;
  int k = 2;

  // Init
  CUDAEngine::init(k, k + 1, p.nphi, p.t);// Init CUDA
  p.q = CUDAEngine::RNSProduct;

  // FV setup
  cipher = new FVContext(p);
  Sampler::init(cipher);
  SecretKey *sk = fv_new_sk(cipher);
  Keys *keys = fv_keygen(cipher, sk);

  // Import keys
  //poly_set_coeff(cipher, &keys->sk.s, 0, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 1, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 2, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 3, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 4, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 5, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 6, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 7, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 8, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 9, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 10, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 11, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 12, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 13, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 14, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 15, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 16, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 17, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 18, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 19, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 20, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 21, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 22, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 23, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 24, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 25, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 26, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 27, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 28, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 29, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 30, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 31, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 32, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 33, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 34, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 35, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 36, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 37, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 38, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 39, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 40, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 41, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 42, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 43, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 44, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 45, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 46, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 47, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 48, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 49, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 50, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 51, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 52, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 53, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 54, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 55, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 56, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 57, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 58, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 59, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 60, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 61, to_ZZ("0")); poly_set_coeff(cipher, &keys->sk.s, 62, to_ZZ("1")); poly_set_coeff(cipher, &keys->sk.s, 63, to_ZZ("1"));
  //poly_set_coeff(cipher, &keys->pk.b, 0, to_ZZ("36122556183")); poly_set_coeff(cipher, &keys->pk.b, 1, to_ZZ("35285770271")); poly_set_coeff(cipher, &keys->pk.b, 2, to_ZZ("29268030692")); poly_set_coeff(cipher, &keys->pk.b, 3, to_ZZ("26720934350")); poly_set_coeff(cipher, &keys->pk.b, 4, to_ZZ("29199993212")); poly_set_coeff(cipher, &keys->pk.b, 5, to_ZZ("28287850391")); poly_set_coeff(cipher, &keys->pk.b, 6, to_ZZ("25812459861")); poly_set_coeff(cipher, &keys->pk.b, 7, to_ZZ("24909565774")); poly_set_coeff(cipher, &keys->pk.b, 8, to_ZZ("25630322323")); poly_set_coeff(cipher, &keys->pk.b, 9, to_ZZ("22613925705")); poly_set_coeff(cipher, &keys->pk.b, 10, to_ZZ("29670584354")); poly_set_coeff(cipher, &keys->pk.b, 11, to_ZZ("23615448079")); poly_set_coeff(cipher, &keys->pk.b, 12, to_ZZ("21653242801")); poly_set_coeff(cipher, &keys->pk.b, 13, to_ZZ("30063003819")); poly_set_coeff(cipher, &keys->pk.b, 14, to_ZZ("20462646124")); poly_set_coeff(cipher, &keys->pk.b, 15, to_ZZ("21592141812")); poly_set_coeff(cipher, &keys->pk.b, 16, to_ZZ("15246504417")); poly_set_coeff(cipher, &keys->pk.b, 17, to_ZZ("12945402429")); poly_set_coeff(cipher, &keys->pk.b, 18, to_ZZ("14388044676")); poly_set_coeff(cipher, &keys->pk.b, 19, to_ZZ("8627838071")); poly_set_coeff(cipher, &keys->pk.b, 20, to_ZZ("16038084338")); poly_set_coeff(cipher, &keys->pk.b, 21, to_ZZ("13030926540")); poly_set_coeff(cipher, &keys->pk.b, 22, to_ZZ("9836863370")); poly_set_coeff(cipher, &keys->pk.b, 23, to_ZZ("11714606505")); poly_set_coeff(cipher, &keys->pk.b, 24, to_ZZ("7860221233")); poly_set_coeff(cipher, &keys->pk.b, 25, to_ZZ("6529171813")); poly_set_coeff(cipher, &keys->pk.b, 26, to_ZZ("6064243223")); poly_set_coeff(cipher, &keys->pk.b, 27, to_ZZ("2953317164")); poly_set_coeff(cipher, &keys->pk.b, 28, to_ZZ("85070591728741592497072111193257802241")); poly_set_coeff(cipher, &keys->pk.b, 29, to_ZZ("227085713")); poly_set_coeff(cipher, &keys->pk.b, 30, to_ZZ("85070591728741592497072111195484860863")); poly_set_coeff(cipher, &keys->pk.b, 31, to_ZZ("85070591728741592497072111196067836101")); poly_set_coeff(cipher, &keys->pk.b, 32, to_ZZ("85070591728741592497072111192383750788")); poly_set_coeff(cipher, &keys->pk.b, 33, to_ZZ("85070591728741592497072111189496441313")); poly_set_coeff(cipher, &keys->pk.b, 34, to_ZZ("85070591728741592497072111195238446297")); poly_set_coeff(cipher, &keys->pk.b, 35, to_ZZ("85070591728741592497072111191041530895")); poly_set_coeff(cipher, &keys->pk.b, 36, to_ZZ("85070591728741592497072111188475541228")); poly_set_coeff(cipher, &keys->pk.b, 37, to_ZZ("85070591728741592497072111187406109742")); poly_set_coeff(cipher, &keys->pk.b, 38, to_ZZ("85070591728741592497072111186472924315")); poly_set_coeff(cipher, &keys->pk.b, 39, to_ZZ("85070591728741592497072111181404950861")); poly_set_coeff(cipher, &keys->pk.b, 40, to_ZZ("85070591728741592497072111185278314544")); poly_set_coeff(cipher, &keys->pk.b, 41, to_ZZ("85070591728741592497072111178778145379")); poly_set_coeff(cipher, &keys->pk.b, 42, to_ZZ("85070591728741592497072111173180615582")); poly_set_coeff(cipher, &keys->pk.b, 43, to_ZZ("85070591728741592497072111176860932141")); poly_set_coeff(cipher, &keys->pk.b, 44, to_ZZ("85070591728741592497072111171317556511")); poly_set_coeff(cipher, &keys->pk.b, 45, to_ZZ("85070591728741592497072111178346265842")); poly_set_coeff(cipher, &keys->pk.b, 46, to_ZZ("85070591728741592497072111176464935920")); poly_set_coeff(cipher, &keys->pk.b, 47, to_ZZ("85070591728741592497072111172901910167")); poly_set_coeff(cipher, &keys->pk.b, 48, to_ZZ("85070591728741592497072111180088318054")); poly_set_coeff(cipher, &keys->pk.b, 49, to_ZZ("85070591728741592497072111168619439104")); poly_set_coeff(cipher, &keys->pk.b, 50, to_ZZ("85070591728741592497072111175052293113")); poly_set_coeff(cipher, &keys->pk.b, 51, to_ZZ("85070591728741592497072111173433238974")); poly_set_coeff(cipher, &keys->pk.b, 52, to_ZZ("85070591728741592497072111172074827212")); poly_set_coeff(cipher, &keys->pk.b, 53, to_ZZ("85070591728741592497072111179651422285")); poly_set_coeff(cipher, &keys->pk.b, 54, to_ZZ("85070591728741592497072111173601854108")); poly_set_coeff(cipher, &keys->pk.b, 55, to_ZZ("85070591728741592497072111169272866709")); poly_set_coeff(cipher, &keys->pk.b, 56, to_ZZ("85070591728741592497072111172753845593")); poly_set_coeff(cipher, &keys->pk.b, 57, to_ZZ("85070591728741592497072111171674697524")); poly_set_coeff(cipher, &keys->pk.b, 58, to_ZZ("85070591728741592497072111165312738782")); poly_set_coeff(cipher, &keys->pk.b, 59, to_ZZ("85070591728741592497072111169036393243")); poly_set_coeff(cipher, &keys->pk.b, 60, to_ZZ("85070591728741592497072111166642938572")); poly_set_coeff(cipher, &keys->pk.b, 61, to_ZZ("85070591728741592497072111167318679742")); poly_set_coeff(cipher, &keys->pk.b, 62, to_ZZ("85070591728741592497072111160812285605")); poly_set_coeff(cipher, &keys->pk.b, 63, to_ZZ("85070591728741592497072111155441208266"));
  //poly_set_coeff(cipher, &keys->pk.a, 0, to_ZZ("1810903149")); poly_set_coeff(cipher, &keys->pk.a, 1, to_ZZ("779124809")); poly_set_coeff(cipher, &keys->pk.a, 2, to_ZZ("1358559585")); poly_set_coeff(cipher, &keys->pk.a, 3, to_ZZ("582939357")); poly_set_coeff(cipher, &keys->pk.a, 4, to_ZZ("1157651205")); poly_set_coeff(cipher, &keys->pk.a, 5, to_ZZ("1000278190")); poly_set_coeff(cipher, &keys->pk.a, 6, to_ZZ("1689718680")); poly_set_coeff(cipher, &keys->pk.a, 7, to_ZZ("1181490728")); poly_set_coeff(cipher, &keys->pk.a, 8, to_ZZ("639723300")); poly_set_coeff(cipher, &keys->pk.a, 9, to_ZZ("1829439990")); poly_set_coeff(cipher, &keys->pk.a, 10, to_ZZ("1698927978")); poly_set_coeff(cipher, &keys->pk.a, 11, to_ZZ("1706735585")); poly_set_coeff(cipher, &keys->pk.a, 12, to_ZZ("2020070753")); poly_set_coeff(cipher, &keys->pk.a, 13, to_ZZ("61570518")); poly_set_coeff(cipher, &keys->pk.a, 14, to_ZZ("1489605366")); poly_set_coeff(cipher, &keys->pk.a, 15, to_ZZ("1414840857")); poly_set_coeff(cipher, &keys->pk.a, 16, to_ZZ("1621788176")); poly_set_coeff(cipher, &keys->pk.a, 17, to_ZZ("2093566990")); poly_set_coeff(cipher, &keys->pk.a, 18, to_ZZ("98240810")); poly_set_coeff(cipher, &keys->pk.a, 19, to_ZZ("320324906")); poly_set_coeff(cipher, &keys->pk.a, 20, to_ZZ("1212933392")); poly_set_coeff(cipher, &keys->pk.a, 21, to_ZZ("615003223")); poly_set_coeff(cipher, &keys->pk.a, 22, to_ZZ("1102845363")); poly_set_coeff(cipher, &keys->pk.a, 23, to_ZZ("914354808")); poly_set_coeff(cipher, &keys->pk.a, 24, to_ZZ("533335915")); poly_set_coeff(cipher, &keys->pk.a, 25, to_ZZ("2141171419")); poly_set_coeff(cipher, &keys->pk.a, 26, to_ZZ("1658290762")); poly_set_coeff(cipher, &keys->pk.a, 27, to_ZZ("1196787089")); poly_set_coeff(cipher, &keys->pk.a, 28, to_ZZ("877890977")); poly_set_coeff(cipher, &keys->pk.a, 29, to_ZZ("99185261")); poly_set_coeff(cipher, &keys->pk.a, 30, to_ZZ("2024416047")); poly_set_coeff(cipher, &keys->pk.a, 31, to_ZZ("148824685")); poly_set_coeff(cipher, &keys->pk.a, 32, to_ZZ("1944864557")); poly_set_coeff(cipher, &keys->pk.a, 33, to_ZZ("1587343021")); poly_set_coeff(cipher, &keys->pk.a, 34, to_ZZ("98449698")); poly_set_coeff(cipher, &keys->pk.a, 35, to_ZZ("1352718166")); poly_set_coeff(cipher, &keys->pk.a, 36, to_ZZ("1911914774")); poly_set_coeff(cipher, &keys->pk.a, 37, to_ZZ("226117335")); poly_set_coeff(cipher, &keys->pk.a, 38, to_ZZ("486854325")); poly_set_coeff(cipher, &keys->pk.a, 39, to_ZZ("1785784055")); poly_set_coeff(cipher, &keys->pk.a, 40, to_ZZ("1837453773")); poly_set_coeff(cipher, &keys->pk.a, 41, to_ZZ("943987008")); poly_set_coeff(cipher, &keys->pk.a, 42, to_ZZ("2044229484")); poly_set_coeff(cipher, &keys->pk.a, 43, to_ZZ("1629913769")); poly_set_coeff(cipher, &keys->pk.a, 44, to_ZZ("2099948295")); poly_set_coeff(cipher, &keys->pk.a, 45, to_ZZ("2023462751")); poly_set_coeff(cipher, &keys->pk.a, 46, to_ZZ("1115424416")); poly_set_coeff(cipher, &keys->pk.a, 47, to_ZZ("1713421141")); poly_set_coeff(cipher, &keys->pk.a, 48, to_ZZ("1602277480")); poly_set_coeff(cipher, &keys->pk.a, 49, to_ZZ("1936506527")); poly_set_coeff(cipher, &keys->pk.a, 50, to_ZZ("861050445")); poly_set_coeff(cipher, &keys->pk.a, 51, to_ZZ("106120547")); poly_set_coeff(cipher, &keys->pk.a, 52, to_ZZ("263767204")); poly_set_coeff(cipher, &keys->pk.a, 53, to_ZZ("270588054")); poly_set_coeff(cipher, &keys->pk.a, 54, to_ZZ("539725270")); poly_set_coeff(cipher, &keys->pk.a, 55, to_ZZ("1197767631")); poly_set_coeff(cipher, &keys->pk.a, 56, to_ZZ("409048447")); poly_set_coeff(cipher, &keys->pk.a, 57, to_ZZ("392015301")); poly_set_coeff(cipher, &keys->pk.a, 58, to_ZZ("1062029037")); poly_set_coeff(cipher, &keys->pk.a, 59, to_ZZ("783373793")); poly_set_coeff(cipher, &keys->pk.a, 60, to_ZZ("2106948956")); poly_set_coeff(cipher, &keys->pk.a, 61, to_ZZ("1413592042")); poly_set_coeff(cipher, &keys->pk.a, 62, to_ZZ("2077713622")); poly_set_coeff(cipher, &keys->pk.a, 63, to_ZZ("2058347534"));
  //poly_set_coeff(cipher, &keys->evk.b[0], 0, to_ZZ("85070591728741592367944902715785900734")); poly_set_coeff(cipher, &keys->evk.b[0], 1, to_ZZ("85070591728741592331051414569195563329")); poly_set_coeff(cipher, &keys->evk.b[0], 2, to_ZZ("85070591728741592404838390858302931571")); poly_set_coeff(cipher, &keys->evk.b[0], 3, to_ZZ("85070591728741592441731878999517029613")); poly_set_coeff(cipher, &keys->evk.b[0], 4, to_ZZ("85070591728741592395615018817785461090")); poly_set_coeff(cipher, &keys->evk.b[0], 5, to_ZZ("85070591728741592404838390856136653813")); poly_set_coeff(cipher, &keys->evk.b[0], 6, to_ZZ("85070591728741592349498158637526376618")); poly_set_coeff(cipher, &keys->evk.b[0], 7, to_ZZ("85070591728741592404838390856739350057")); poly_set_coeff(cipher, &keys->evk.b[0], 8, to_ZZ("85070591728741592441731878996697375421")); poly_set_coeff(cipher, &keys->evk.b[0], 9, to_ZZ("85070591728741592404838390852742438559")); poly_set_coeff(cipher, &keys->evk.b[0], 10, to_ZZ("85070591728741592432508506958286920163")); poly_set_coeff(cipher, &keys->evk.b[0], 11, to_ZZ("85070591728741592404838390850818659766")); poly_set_coeff(cipher, &keys->evk.b[0], 12, to_ZZ("85070591728741592414061762883408914477")); poly_set_coeff(cipher, &keys->evk.b[0], 13, to_ZZ("85070591728741592367944902706934991386")); poly_set_coeff(cipher, &keys->evk.b[0], 14, to_ZZ("85070591728741592414061762888837698330")); poly_set_coeff(cipher, &keys->evk.b[0], 15, to_ZZ("85070591728741592404838390848530864186")); poly_set_coeff(cipher, &keys->evk.b[0], 16, to_ZZ("85070591728741592460178623066459085114")); poly_set_coeff(cipher, &keys->evk.b[0], 17, to_ZZ("85070591728741592478625367133854723843")); poly_set_coeff(cipher, &keys->evk.b[0], 18, to_ZZ("85070591728741592450955251023549813297")); poly_set_coeff(cipher, &keys->evk.b[0], 19, to_ZZ("85070591728741592478625367135172560120")); poly_set_coeff(cipher, &keys->evk.b[0], 20, to_ZZ("85070591728741592414061762878282878987")); poly_set_coeff(cipher, &keys->evk.b[0], 21, to_ZZ("85070591728741592478625367131972451023")); poly_set_coeff(cipher, &keys->evk.b[0], 22, to_ZZ("85070591728741592460178623055793626882")); poly_set_coeff(cipher, &keys->evk.b[0], 23, to_ZZ("85070591728741592441731878983897117383")); poly_set_coeff(cipher, &keys->evk.b[0], 24, to_ZZ("85070591728741592478625367129406772495")); poly_set_coeff(cipher, &keys->evk.b[0], 25, to_ZZ("85070591728741592460178623052836441967")); poly_set_coeff(cipher, &keys->evk.b[0], 26, to_ZZ("85070591728741592460178623051895568882")); poly_set_coeff(cipher, &keys->evk.b[0], 27, to_ZZ("85070591728741592460178623057002478892")); poly_set_coeff(cipher, &keys->evk.b[0], 28, to_ZZ("85070591728741592469401995089228700324")); poly_set_coeff(cipher, &keys->evk.b[0], 29, to_ZZ("36893488139432994761")); poly_set_coeff(cipher, &keys->evk.b[0], 30, to_ZZ("83010348323825588029")); poly_set_coeff(cipher, &keys->evk.b[0], 31, to_ZZ("36893488137055769937")); poly_set_coeff(cipher, &keys->evk.b[0], 32, to_ZZ("9223372029070835563")); poly_set_coeff(cipher, &keys->evk.b[0], 33, to_ZZ("73786976280855531503")); poly_set_coeff(cipher, &keys->evk.b[0], 34, to_ZZ("55340232210455867124")); poly_set_coeff(cipher, &keys->evk.b[0], 35, to_ZZ("55340232204892548449")); poly_set_coeff(cipher, &keys->evk.b[0], 36, to_ZZ("18446744060010356119")); poly_set_coeff(cipher, &keys->evk.b[0], 37, to_ZZ("55340232200751299702")); poly_set_coeff(cipher, &keys->evk.b[0], 38, to_ZZ("92233720348481375806")); poly_set_coeff(cipher, &keys->evk.b[0], 39, to_ZZ("55340232203195259612")); poly_set_coeff(cipher, &keys->evk.b[0], 40, to_ZZ("36893488129581802261")); poly_set_coeff(cipher, &keys->evk.b[0], 41, to_ZZ("73786976279783208039")); poly_set_coeff(cipher, &keys->evk.b[0], 42, to_ZZ("92233720342436326504")); poly_set_coeff(cipher, &keys->evk.b[0], 43, to_ZZ("110680464416657873129")); poly_set_coeff(cipher, &keys->evk.b[0], 44, to_ZZ("129127208489545970885")); poly_set_coeff(cipher, &keys->evk.b[0], 45, to_ZZ("73786976270319988490")); poly_set_coeff(cipher, &keys->evk.b[0], 46, to_ZZ("83010348312348783701")); poly_set_coeff(cipher, &keys->evk.b[0], 47, to_ZZ("55340232201095846970")); poly_set_coeff(cipher, &keys->evk.b[0], 48, to_ZZ("64563604236419741291")); poly_set_coeff(cipher, &keys->evk.b[0], 49, to_ZZ("92233720345214871779")); poly_set_coeff(cipher, &keys->evk.b[0], 50, to_ZZ("73786976270415181310")); poly_set_coeff(cipher, &keys->evk.b[0], 51, to_ZZ("129127208490408010648")); poly_set_coeff(cipher, &keys->evk.b[0], 52, to_ZZ("129127208485201770895")); poly_set_coeff(cipher, &keys->evk.b[0], 53, to_ZZ("55340232200016218647")); poly_set_coeff(cipher, &keys->evk.b[0], 54, to_ZZ("138350580527520790910")); poly_set_coeff(cipher, &keys->evk.b[0], 55, to_ZZ("129127208483339019044")); poly_set_coeff(cipher, &keys->evk.b[0], 56, to_ZZ("156797324590645552191")); poly_set_coeff(cipher, &keys->evk.b[0], 57, to_ZZ("147573952554938082820")); poly_set_coeff(cipher, &keys->evk.b[0], 58, to_ZZ("138350580517326182283")); poly_set_coeff(cipher, &keys->evk.b[0], 59, to_ZZ("129127208484664801851")); poly_set_coeff(cipher, &keys->evk.b[0], 60, to_ZZ("92233720339148747600")); poly_set_coeff(cipher, &keys->evk.b[0], 61, to_ZZ("110680464412543139799")); poly_set_coeff(cipher, &keys->evk.b[0], 62, to_ZZ("101457092370867576430")); poly_set_coeff(cipher, &keys->evk.b[0], 63, to_ZZ("129127208478560282921"));
  //poly_set_coeff(cipher, &keys->evk.b[1], 0, to_ZZ("85070591728741592367944902716923738415")); poly_set_coeff(cipher, &keys->evk.b[1], 1, to_ZZ("85070591728741592331051414571084530154")); poly_set_coeff(cipher, &keys->evk.b[1], 2, to_ZZ("85070591728741592404838390860979565757")); poly_set_coeff(cipher, &keys->evk.b[1], 3, to_ZZ("85070591728741592441731879002633589657")); poly_set_coeff(cipher, &keys->evk.b[1], 4, to_ZZ("85070591728741592395615018814932220064")); poly_set_coeff(cipher, &keys->evk.b[1], 5, to_ZZ("85070591728741592404838390855577209005")); poly_set_coeff(cipher, &keys->evk.b[1], 6, to_ZZ("85070591728741592349498158636121559637")); poly_set_coeff(cipher, &keys->evk.b[1], 7, to_ZZ("85070591728741592404838390850520429170")); poly_set_coeff(cipher, &keys->evk.b[1], 8, to_ZZ("85070591728741592441731879005878552347")); poly_set_coeff(cipher, &keys->evk.b[1], 9, to_ZZ("85070591728741592404838390847756673790")); poly_set_coeff(cipher, &keys->evk.b[1], 10, to_ZZ("85070591728741592432508506957679314384")); poly_set_coeff(cipher, &keys->evk.b[1], 11, to_ZZ("85070591728741592404838390852016385814")); poly_set_coeff(cipher, &keys->evk.b[1], 12, to_ZZ("85070591728741592414061762886620249920")); poly_set_coeff(cipher, &keys->evk.b[1], 13, to_ZZ("85070591728741592367944902712158422318")); poly_set_coeff(cipher, &keys->evk.b[1], 14, to_ZZ("85070591728741592414061762888974228230")); poly_set_coeff(cipher, &keys->evk.b[1], 15, to_ZZ("85070591728741592404838390852958110279")); poly_set_coeff(cipher, &keys->evk.b[1], 16, to_ZZ("85070591728741592460178623064069527953")); poly_set_coeff(cipher, &keys->evk.b[1], 17, to_ZZ("85070591728741592478625367133610475191")); poly_set_coeff(cipher, &keys->evk.b[1], 18, to_ZZ("85070591728741592450955251028378679300")); poly_set_coeff(cipher, &keys->evk.b[1], 19, to_ZZ("85070591728741592478625367134043108909")); poly_set_coeff(cipher, &keys->evk.b[1], 20, to_ZZ("85070591728741592414061762879453217858")); poly_set_coeff(cipher, &keys->evk.b[1], 21, to_ZZ("85070591728741592478625367134233946578")); poly_set_coeff(cipher, &keys->evk.b[1], 22, to_ZZ("85070591728741592460178623064893292613")); poly_set_coeff(cipher, &keys->evk.b[1], 23, to_ZZ("85070591728741592441731878978638632155")); poly_set_coeff(cipher, &keys->evk.b[1], 24, to_ZZ("85070591728741592478625367133231535177")); poly_set_coeff(cipher, &keys->evk.b[1], 25, to_ZZ("85070591728741592460178623060504730507")); poly_set_coeff(cipher, &keys->evk.b[1], 26, to_ZZ("85070591728741592460178623055840002308")); poly_set_coeff(cipher, &keys->evk.b[1], 27, to_ZZ("85070591728741592460178623059176657211")); poly_set_coeff(cipher, &keys->evk.b[1], 28, to_ZZ("85070591728741592469401995086862967179")); poly_set_coeff(cipher, &keys->evk.b[1], 29, to_ZZ("36893488147051516396")); poly_set_coeff(cipher, &keys->evk.b[1], 30, to_ZZ("83010348321263813931")); poly_set_coeff(cipher, &keys->evk.b[1], 31, to_ZZ("36893488137276328300")); poly_set_coeff(cipher, &keys->evk.b[1], 32, to_ZZ("9223372030307694954")); poly_set_coeff(cipher, &keys->evk.b[1], 33, to_ZZ("73786976287986991674")); poly_set_coeff(cipher, &keys->evk.b[1], 34, to_ZZ("55340232215397134886")); poly_set_coeff(cipher, &keys->evk.b[1], 35, to_ZZ("55340232208891255520")); poly_set_coeff(cipher, &keys->evk.b[1], 36, to_ZZ("18446744065287603414")); poly_set_coeff(cipher, &keys->evk.b[1], 37, to_ZZ("55340232207592714904")); poly_set_coeff(cipher, &keys->evk.b[1], 38, to_ZZ("92233720356213002533")); poly_set_coeff(cipher, &keys->evk.b[1], 39, to_ZZ("55340232205399804180")); poly_set_coeff(cipher, &keys->evk.b[1], 40, to_ZZ("36893488134663863589")); poly_set_coeff(cipher, &keys->evk.b[1], 41, to_ZZ("73786976277245154602")); poly_set_coeff(cipher, &keys->evk.b[1], 42, to_ZZ("92233720338321394529")); poly_set_coeff(cipher, &keys->evk.b[1], 43, to_ZZ("110680464421619430217")); poly_set_coeff(cipher, &keys->evk.b[1], 44, to_ZZ("129127208489584378711")); poly_set_coeff(cipher, &keys->evk.b[1], 45, to_ZZ("73786976273831763952")); poly_set_coeff(cipher, &keys->evk.b[1], 46, to_ZZ("83010348312359850089")); poly_set_coeff(cipher, &keys->evk.b[1], 47, to_ZZ("55340232207956979519")); poly_set_coeff(cipher, &keys->evk.b[1], 48, to_ZZ("64563604240846770274")); poly_set_coeff(cipher, &keys->evk.b[1], 49, to_ZZ("92233720347560939937")); poly_set_coeff(cipher, &keys->evk.b[1], 50, to_ZZ("73786976276227831374")); poly_set_coeff(cipher, &keys->evk.b[1], 51, to_ZZ("129127208489693862579")); poly_set_coeff(cipher, &keys->evk.b[1], 52, to_ZZ("129127208492354825435")); poly_set_coeff(cipher, &keys->evk.b[1], 53, to_ZZ("55340232192036073105")); poly_set_coeff(cipher, &keys->evk.b[1], 54, to_ZZ("138350580530428193116")); poly_set_coeff(cipher, &keys->evk.b[1], 55, to_ZZ("129127208487295964901")); poly_set_coeff(cipher, &keys->evk.b[1], 56, to_ZZ("156797324587970878622")); poly_set_coeff(cipher, &keys->evk.b[1], 57, to_ZZ("147573952560626130830")); poly_set_coeff(cipher, &keys->evk.b[1], 58, to_ZZ("138350580517506295097")); poly_set_coeff(cipher, &keys->evk.b[1], 59, to_ZZ("129127208488115555435")); poly_set_coeff(cipher, &keys->evk.b[1], 60, to_ZZ("92233720342200926135")); poly_set_coeff(cipher, &keys->evk.b[1], 61, to_ZZ("110680464412141107875")); poly_set_coeff(cipher, &keys->evk.b[1], 62, to_ZZ("101457092378910352994")); poly_set_coeff(cipher, &keys->evk.b[1], 63, to_ZZ("129127208479325885027"));
  //poly_set_coeff(cipher, &keys->evk.a[0], 0, to_ZZ("1142733657")); poly_set_coeff(cipher, &keys->evk.a[0], 1, to_ZZ("1713713754")); poly_set_coeff(cipher, &keys->evk.a[0], 2, to_ZZ("1478785661")); poly_set_coeff(cipher, &keys->evk.a[0], 3, to_ZZ("1891869394")); poly_set_coeff(cipher, &keys->evk.a[0], 4, to_ZZ("1245263915")); poly_set_coeff(cipher, &keys->evk.a[0], 5, to_ZZ("1695890269")); poly_set_coeff(cipher, &keys->evk.a[0], 6, to_ZZ("362485553")); poly_set_coeff(cipher, &keys->evk.a[0], 7, to_ZZ("2138880017")); poly_set_coeff(cipher, &keys->evk.a[0], 8, to_ZZ("1297352958")); poly_set_coeff(cipher, &keys->evk.a[0], 9, to_ZZ("1285311044")); poly_set_coeff(cipher, &keys->evk.a[0], 10, to_ZZ("1955377394")); poly_set_coeff(cipher, &keys->evk.a[0], 11, to_ZZ("1773247384")); poly_set_coeff(cipher, &keys->evk.a[0], 12, to_ZZ("516954597")); poly_set_coeff(cipher, &keys->evk.a[0], 13, to_ZZ("759714858")); poly_set_coeff(cipher, &keys->evk.a[0], 14, to_ZZ("1002683681")); poly_set_coeff(cipher, &keys->evk.a[0], 15, to_ZZ("1037301999")); poly_set_coeff(cipher, &keys->evk.a[0], 16, to_ZZ("1560975424")); poly_set_coeff(cipher, &keys->evk.a[0], 17, to_ZZ("1322214248")); poly_set_coeff(cipher, &keys->evk.a[0], 18, to_ZZ("1606342296")); poly_set_coeff(cipher, &keys->evk.a[0], 19, to_ZZ("788807939")); poly_set_coeff(cipher, &keys->evk.a[0], 20, to_ZZ("1722997386")); poly_set_coeff(cipher, &keys->evk.a[0], 21, to_ZZ("434972116")); poly_set_coeff(cipher, &keys->evk.a[0], 22, to_ZZ("1703607218")); poly_set_coeff(cipher, &keys->evk.a[0], 23, to_ZZ("1111946153")); poly_set_coeff(cipher, &keys->evk.a[0], 24, to_ZZ("375902388")); poly_set_coeff(cipher, &keys->evk.a[0], 25, to_ZZ("976032244")); poly_set_coeff(cipher, &keys->evk.a[0], 26, to_ZZ("1526163085")); poly_set_coeff(cipher, &keys->evk.a[0], 27, to_ZZ("132414901")); poly_set_coeff(cipher, &keys->evk.a[0], 28, to_ZZ("2135069858")); poly_set_coeff(cipher, &keys->evk.a[0], 29, to_ZZ("1343651819")); poly_set_coeff(cipher, &keys->evk.a[0], 30, to_ZZ("1586771814")); poly_set_coeff(cipher, &keys->evk.a[0], 31, to_ZZ("628856406")); poly_set_coeff(cipher, &keys->evk.a[0], 32, to_ZZ("823636637")); poly_set_coeff(cipher, &keys->evk.a[0], 33, to_ZZ("1856518431")); poly_set_coeff(cipher, &keys->evk.a[0], 34, to_ZZ("471680046")); poly_set_coeff(cipher, &keys->evk.a[0], 35, to_ZZ("395237006")); poly_set_coeff(cipher, &keys->evk.a[0], 36, to_ZZ("2144599743")); poly_set_coeff(cipher, &keys->evk.a[0], 37, to_ZZ("1201876323")); poly_set_coeff(cipher, &keys->evk.a[0], 38, to_ZZ("1539312797")); poly_set_coeff(cipher, &keys->evk.a[0], 39, to_ZZ("569468933")); poly_set_coeff(cipher, &keys->evk.a[0], 40, to_ZZ("1411386243")); poly_set_coeff(cipher, &keys->evk.a[0], 41, to_ZZ("1162022074")); poly_set_coeff(cipher, &keys->evk.a[0], 42, to_ZZ("1688978543")); poly_set_coeff(cipher, &keys->evk.a[0], 43, to_ZZ("1218181369")); poly_set_coeff(cipher, &keys->evk.a[0], 44, to_ZZ("205014195")); poly_set_coeff(cipher, &keys->evk.a[0], 45, to_ZZ("895042166")); poly_set_coeff(cipher, &keys->evk.a[0], 46, to_ZZ("787920281")); poly_set_coeff(cipher, &keys->evk.a[0], 47, to_ZZ("789991922")); poly_set_coeff(cipher, &keys->evk.a[0], 48, to_ZZ("733826011")); poly_set_coeff(cipher, &keys->evk.a[0], 49, to_ZZ("1694341421")); poly_set_coeff(cipher, &keys->evk.a[0], 50, to_ZZ("854838454")); poly_set_coeff(cipher, &keys->evk.a[0], 51, to_ZZ("1032270883")); poly_set_coeff(cipher, &keys->evk.a[0], 52, to_ZZ("257274080")); poly_set_coeff(cipher, &keys->evk.a[0], 53, to_ZZ("905600988")); poly_set_coeff(cipher, &keys->evk.a[0], 54, to_ZZ("1624129532")); poly_set_coeff(cipher, &keys->evk.a[0], 55, to_ZZ("1901731320")); poly_set_coeff(cipher, &keys->evk.a[0], 56, to_ZZ("2046835749")); poly_set_coeff(cipher, &keys->evk.a[0], 57, to_ZZ("119716767")); poly_set_coeff(cipher, &keys->evk.a[0], 58, to_ZZ("22252335")); poly_set_coeff(cipher, &keys->evk.a[0], 59, to_ZZ("966752037")); poly_set_coeff(cipher, &keys->evk.a[0], 60, to_ZZ("627770605")); poly_set_coeff(cipher, &keys->evk.a[0], 61, to_ZZ("1268588014")); poly_set_coeff(cipher, &keys->evk.a[0], 62, to_ZZ("1430577575")); poly_set_coeff(cipher, &keys->evk.a[0], 63, to_ZZ("852975755"));
  //poly_set_coeff(cipher, &keys->evk.a[1], 0, to_ZZ("641802633")); poly_set_coeff(cipher, &keys->evk.a[1], 1, to_ZZ("1031341031")); poly_set_coeff(cipher, &keys->evk.a[1], 2, to_ZZ("2017601132")); poly_set_coeff(cipher, &keys->evk.a[1], 3, to_ZZ("2035763035")); poly_set_coeff(cipher, &keys->evk.a[1], 4, to_ZZ("2051957730")); poly_set_coeff(cipher, &keys->evk.a[1], 5, to_ZZ("107917457")); poly_set_coeff(cipher, &keys->evk.a[1], 6, to_ZZ("168154820")); poly_set_coeff(cipher, &keys->evk.a[1], 7, to_ZZ("1907659421")); poly_set_coeff(cipher, &keys->evk.a[1], 8, to_ZZ("655850384")); poly_set_coeff(cipher, &keys->evk.a[1], 9, to_ZZ("1973890591")); poly_set_coeff(cipher, &keys->evk.a[1], 10, to_ZZ("897237116")); poly_set_coeff(cipher, &keys->evk.a[1], 11, to_ZZ("1078045414")); poly_set_coeff(cipher, &keys->evk.a[1], 12, to_ZZ("741965062")); poly_set_coeff(cipher, &keys->evk.a[1], 13, to_ZZ("456246618")); poly_set_coeff(cipher, &keys->evk.a[1], 14, to_ZZ("1743185683")); poly_set_coeff(cipher, &keys->evk.a[1], 15, to_ZZ("1159035055")); poly_set_coeff(cipher, &keys->evk.a[1], 16, to_ZZ("1854930982")); poly_set_coeff(cipher, &keys->evk.a[1], 17, to_ZZ("1011432282")); poly_set_coeff(cipher, &keys->evk.a[1], 18, to_ZZ("874027830")); poly_set_coeff(cipher, &keys->evk.a[1], 19, to_ZZ("396587168")); poly_set_coeff(cipher, &keys->evk.a[1], 20, to_ZZ("866082275")); poly_set_coeff(cipher, &keys->evk.a[1], 21, to_ZZ("1126939570")); poly_set_coeff(cipher, &keys->evk.a[1], 22, to_ZZ("331753488")); poly_set_coeff(cipher, &keys->evk.a[1], 23, to_ZZ("1797039729")); poly_set_coeff(cipher, &keys->evk.a[1], 24, to_ZZ("1111213603")); poly_set_coeff(cipher, &keys->evk.a[1], 25, to_ZZ("240618720")); poly_set_coeff(cipher, &keys->evk.a[1], 26, to_ZZ("1446010669")); poly_set_coeff(cipher, &keys->evk.a[1], 27, to_ZZ("1953135717")); poly_set_coeff(cipher, &keys->evk.a[1], 28, to_ZZ("1618038592")); poly_set_coeff(cipher, &keys->evk.a[1], 29, to_ZZ("1573885343")); poly_set_coeff(cipher, &keys->evk.a[1], 30, to_ZZ("924589544")); poly_set_coeff(cipher, &keys->evk.a[1], 31, to_ZZ("2044054887")); poly_set_coeff(cipher, &keys->evk.a[1], 32, to_ZZ("109810109")); poly_set_coeff(cipher, &keys->evk.a[1], 33, to_ZZ("47595646")); poly_set_coeff(cipher, &keys->evk.a[1], 34, to_ZZ("1300255287")); poly_set_coeff(cipher, &keys->evk.a[1], 35, to_ZZ("1512866857")); poly_set_coeff(cipher, &keys->evk.a[1], 36, to_ZZ("251865848")); poly_set_coeff(cipher, &keys->evk.a[1], 37, to_ZZ("1768701199")); poly_set_coeff(cipher, &keys->evk.a[1], 38, to_ZZ("483479012")); poly_set_coeff(cipher, &keys->evk.a[1], 39, to_ZZ("2141966991")); poly_set_coeff(cipher, &keys->evk.a[1], 40, to_ZZ("2015136653")); poly_set_coeff(cipher, &keys->evk.a[1], 41, to_ZZ("2114113812")); poly_set_coeff(cipher, &keys->evk.a[1], 42, to_ZZ("2113276561")); poly_set_coeff(cipher, &keys->evk.a[1], 43, to_ZZ("12542831")); poly_set_coeff(cipher, &keys->evk.a[1], 44, to_ZZ("510052649")); poly_set_coeff(cipher, &keys->evk.a[1], 45, to_ZZ("219224412")); poly_set_coeff(cipher, &keys->evk.a[1], 46, to_ZZ("690723956")); poly_set_coeff(cipher, &keys->evk.a[1], 47, to_ZZ("1153407420")); poly_set_coeff(cipher, &keys->evk.a[1], 48, to_ZZ("485282191")); poly_set_coeff(cipher, &keys->evk.a[1], 49, to_ZZ("2127313064")); poly_set_coeff(cipher, &keys->evk.a[1], 50, to_ZZ("1316665105")); poly_set_coeff(cipher, &keys->evk.a[1], 51, to_ZZ("1451482819")); poly_set_coeff(cipher, &keys->evk.a[1], 52, to_ZZ("51170683")); poly_set_coeff(cipher, &keys->evk.a[1], 53, to_ZZ("1900971458")); poly_set_coeff(cipher, &keys->evk.a[1], 54, to_ZZ("34872553")); poly_set_coeff(cipher, &keys->evk.a[1], 55, to_ZZ("1004160091")); poly_set_coeff(cipher, &keys->evk.a[1], 56, to_ZZ("2130648553")); poly_set_coeff(cipher, &keys->evk.a[1], 57, to_ZZ("50581260")); poly_set_coeff(cipher, &keys->evk.a[1], 58, to_ZZ("975046807")); poly_set_coeff(cipher, &keys->evk.a[1], 59, to_ZZ("741973907")); poly_set_coeff(cipher, &keys->evk.a[1], 60, to_ZZ("2021412152")); poly_set_coeff(cipher, &keys->evk.a[1], 61, to_ZZ("272269979")); poly_set_coeff(cipher, &keys->evk.a[1], 62, to_ZZ("868154601")); poly_set_coeff(cipher, &keys->evk.a[1], 63, to_ZZ("1871374555"));

  // Keys
  // std::cout << "sk: " << poly_to_string(cipher, &keys->sk.s) << std::endl<< std::endl;
  // std::cout << "pk.b: " << poly_to_string(cipher, &keys->pk.b) << std::endl;
  // std::cout << "pk.a: " << poly_to_string(cipher, &keys->pk.a) << std::endl<< std::endl;
  // for(int i = 0; i < CUDAEngine::RNSPrimes.size(); i++)
  //   std::cout << "evk.b[" << i << "]: " << poly_to_string(cipher, &keys->evk.b[i]) << std::endl;
  // std::cout << std::endl;
  // for(int i = 0; i < CUDAEngine::RNSPrimes.size(); i++)
  //   std::cout << "evk.a[" << i << "]: " << poly_to_string(cipher, &keys->evk.a[i]) << std::endl;
  // std::cout << std::endl;

  /////////////
  // Message //
  /////////////
  poly_t m1, m2;
  poly_init(cipher, &m1);
  poly_init(cipher, &m2);

  //Sampler::sample(cipher, &m1, UNIFORM);
  //Sampler::sample(cipher, &m2, UNIFORM);
  poly_set_coeff(cipher, &m1, 0, to_ZZ(42));
  poly_set_coeff(cipher, &m2, 0, to_ZZ(0));

  // Copy to GPU's global memory
  poly_copy_to_device(cipher, &m1);
  poly_copy_to_device(cipher, &m2);

  /////////////
  // Encrypt //
  /////////////
  cipher_t* ct1 = fv_encrypt(cipher, &m1);
  cipher_t* ct2 = fv_encrypt(cipher, &m2);
  cipher_t* ct3 = new cipher_t;
  cipher_init(cipher, ct3);

  //poly_set_coeff(cipher, &ct1->c[0], 0, to_ZZ("13956893955496667519050893322146912776")); poly_set_coeff(cipher, &ct1->c[0], 1, to_ZZ("73313271675")); poly_set_coeff(cipher, &ct1->c[0], 2, to_ZZ("113353487430")); poly_set_coeff(cipher, &ct1->c[0], 3, to_ZZ("134526970016")); poly_set_coeff(cipher, &ct1->c[0], 4, to_ZZ("141175763033")); poly_set_coeff(cipher, &ct1->c[0], 5, to_ZZ("206970937001")); poly_set_coeff(cipher, &ct1->c[0], 6, to_ZZ("186643446450")); poly_set_coeff(cipher, &ct1->c[0], 7, to_ZZ("196148349187")); poly_set_coeff(cipher, &ct1->c[0], 8, to_ZZ("234467734053")); poly_set_coeff(cipher, &ct1->c[0], 9, to_ZZ("266069228616")); poly_set_coeff(cipher, &ct1->c[0], 10, to_ZZ("301001797038")); poly_set_coeff(cipher, &ct1->c[0], 11, to_ZZ("305029090679")); poly_set_coeff(cipher, &ct1->c[0], 12, to_ZZ("310150608445")); poly_set_coeff(cipher, &ct1->c[0], 13, to_ZZ("350540716693")); poly_set_coeff(cipher, &ct1->c[0], 14, to_ZZ("372567575757")); poly_set_coeff(cipher, &ct1->c[0], 15, to_ZZ("397031841638")); poly_set_coeff(cipher, &ct1->c[0], 16, to_ZZ("430589024317")); poly_set_coeff(cipher, &ct1->c[0], 17, to_ZZ("406721957533")); poly_set_coeff(cipher, &ct1->c[0], 18, to_ZZ("417198675833")); poly_set_coeff(cipher, &ct1->c[0], 19, to_ZZ("443548233410")); poly_set_coeff(cipher, &ct1->c[0], 20, to_ZZ("428363735910")); poly_set_coeff(cipher, &ct1->c[0], 21, to_ZZ("457344059640")); poly_set_coeff(cipher, &ct1->c[0], 22, to_ZZ("466857790466")); poly_set_coeff(cipher, &ct1->c[0], 23, to_ZZ("469407986525")); poly_set_coeff(cipher, &ct1->c[0], 24, to_ZZ("490236364119")); poly_set_coeff(cipher, &ct1->c[0], 25, to_ZZ("483374036757")); poly_set_coeff(cipher, &ct1->c[0], 26, to_ZZ("473964010538")); poly_set_coeff(cipher, &ct1->c[0], 27, to_ZZ("497198973554")); poly_set_coeff(cipher, &ct1->c[0], 28, to_ZZ("489379194444")); poly_set_coeff(cipher, &ct1->c[0], 29, to_ZZ("478713949691")); poly_set_coeff(cipher, &ct1->c[0], 30, to_ZZ("510587815183")); poly_set_coeff(cipher, &ct1->c[0], 31, to_ZZ("498133930853")); poly_set_coeff(cipher, &ct1->c[0], 32, to_ZZ("517114667194")); poly_set_coeff(cipher, &ct1->c[0], 33, to_ZZ("494606583568")); poly_set_coeff(cipher, &ct1->c[0], 34, to_ZZ("471851370722")); poly_set_coeff(cipher, &ct1->c[0], 35, to_ZZ("525842837842")); poly_set_coeff(cipher, &ct1->c[0], 36, to_ZZ("493236252546")); poly_set_coeff(cipher, &ct1->c[0], 37, to_ZZ("476878174472")); poly_set_coeff(cipher, &ct1->c[0], 38, to_ZZ("471090815271")); poly_set_coeff(cipher, &ct1->c[0], 39, to_ZZ("432651620702")); poly_set_coeff(cipher, &ct1->c[0], 40, to_ZZ("470409571203")); poly_set_coeff(cipher, &ct1->c[0], 41, to_ZZ("433730817420")); poly_set_coeff(cipher, &ct1->c[0], 42, to_ZZ("389884563315")); poly_set_coeff(cipher, &ct1->c[0], 43, to_ZZ("389731719450")); poly_set_coeff(cipher, &ct1->c[0], 44, to_ZZ("365126749565")); poly_set_coeff(cipher, &ct1->c[0], 45, to_ZZ("345611992751")); poly_set_coeff(cipher, &ct1->c[0], 46, to_ZZ("352745446436")); poly_set_coeff(cipher, &ct1->c[0], 47, to_ZZ("326606369117")); poly_set_coeff(cipher, &ct1->c[0], 48, to_ZZ("318565547571")); poly_set_coeff(cipher, &ct1->c[0], 49, to_ZZ("312101787673")); poly_set_coeff(cipher, &ct1->c[0], 50, to_ZZ("270247996485")); poly_set_coeff(cipher, &ct1->c[0], 51, to_ZZ("264153254818")); poly_set_coeff(cipher, &ct1->c[0], 52, to_ZZ("229078896019")); poly_set_coeff(cipher, &ct1->c[0], 53, to_ZZ("209839585072")); poly_set_coeff(cipher, &ct1->c[0], 54, to_ZZ("215119169230")); poly_set_coeff(cipher, &ct1->c[0], 55, to_ZZ("193309459826")); poly_set_coeff(cipher, &ct1->c[0], 56, to_ZZ("174327135685")); poly_set_coeff(cipher, &ct1->c[0], 57, to_ZZ("152364431246")); poly_set_coeff(cipher, &ct1->c[0], 58, to_ZZ("121533991393")); poly_set_coeff(cipher, &ct1->c[0], 59, to_ZZ("96337466817")); poly_set_coeff(cipher, &ct1->c[0], 60, to_ZZ("66424235165")); poly_set_coeff(cipher, &ct1->c[0], 61, to_ZZ("35518420824")); poly_set_coeff(cipher, &ct1->c[0], 62, to_ZZ("37026298016")); poly_set_coeff(cipher, &ct1->c[0], 63, to_ZZ("2612378725"));
  //poly_set_coeff(cipher, &ct1->c[1], 0, to_ZZ("85070591728741592497072111162813137540")); poly_set_coeff(cipher, &ct1->c[1], 1, to_ZZ("85070591728741592497072111169086013245")); poly_set_coeff(cipher, &ct1->c[1], 2, to_ZZ("85070591728741592497072111168685814825")); poly_set_coeff(cipher, &ct1->c[1], 3, to_ZZ("85070591728741592497072111165395414880")); poly_set_coeff(cipher, &ct1->c[1], 4, to_ZZ("85070591728741592497072111171668182382")); poly_set_coeff(cipher, &ct1->c[1], 5, to_ZZ("85070591728741592497072111168145574956")); poly_set_coeff(cipher, &ct1->c[1], 6, to_ZZ("85070591728741592497072111177172136969")); poly_set_coeff(cipher, &ct1->c[1], 7, to_ZZ("85070591728741592497072111178957547641")); poly_set_coeff(cipher, &ct1->c[1], 8, to_ZZ("85070591728741592497072111169785036078")); poly_set_coeff(cipher, &ct1->c[1], 9, to_ZZ("85070591728741592497072111174307714631")); poly_set_coeff(cipher, &ct1->c[1], 10, to_ZZ("85070591728741592497072111181151827283")); poly_set_coeff(cipher, &ct1->c[1], 11, to_ZZ("85070591728741592497072111183600148678")); poly_set_coeff(cipher, &ct1->c[1], 12, to_ZZ("85070591728741592497072111188207295801")); poly_set_coeff(cipher, &ct1->c[1], 13, to_ZZ("85070591728741592497072111177592364425")); poly_set_coeff(cipher, &ct1->c[1], 14, to_ZZ("85070591728741592497072111176924387119")); poly_set_coeff(cipher, &ct1->c[1], 15, to_ZZ("85070591728741592497072111186274564775")); poly_set_coeff(cipher, &ct1->c[1], 16, to_ZZ("85070591728741592497072111183755484707")); poly_set_coeff(cipher, &ct1->c[1], 17, to_ZZ("85070591728741592497072111189913817016")); poly_set_coeff(cipher, &ct1->c[1], 18, to_ZZ("85070591728741592497072111187922558943")); poly_set_coeff(cipher, &ct1->c[1], 19, to_ZZ("85070591728741592497072111187131029515")); poly_set_coeff(cipher, &ct1->c[1], 20, to_ZZ("85070591728741592497072111188966721567")); poly_set_coeff(cipher, &ct1->c[1], 21, to_ZZ("85070591728741592497072111185616273631")); poly_set_coeff(cipher, &ct1->c[1], 22, to_ZZ("85070591728741592497072111191363069111")); poly_set_coeff(cipher, &ct1->c[1], 23, to_ZZ("85070591728741592497072111188081251218")); poly_set_coeff(cipher, &ct1->c[1], 24, to_ZZ("85070591728741592497072111187546418056")); poly_set_coeff(cipher, &ct1->c[1], 25, to_ZZ("85070591728741592497072111194533667671")); poly_set_coeff(cipher, &ct1->c[1], 26, to_ZZ("85070591728741592497072111197896027482")); poly_set_coeff(cipher, &ct1->c[1], 27, to_ZZ("85070591728741592497072111197071397035")); poly_set_coeff(cipher, &ct1->c[1], 28, to_ZZ("85070591728741592497072111194108561851")); poly_set_coeff(cipher, &ct1->c[1], 29, to_ZZ("85070591728741592497072111190601285951")); poly_set_coeff(cipher, &ct1->c[1], 30, to_ZZ("85070591728741592497072111189867155873")); poly_set_coeff(cipher, &ct1->c[1], 31, to_ZZ("85070591728741592497072111193062997057")); poly_set_coeff(cipher, &ct1->c[1], 32, to_ZZ("85070591728741592497072111192759111353")); poly_set_coeff(cipher, &ct1->c[1], 33, to_ZZ("85070591728741592497072111189820390087")); poly_set_coeff(cipher, &ct1->c[1], 34, to_ZZ("85070591728741592497072111197226277010")); poly_set_coeff(cipher, &ct1->c[1], 35, to_ZZ("85070591728741592497072111196992053741")); poly_set_coeff(cipher, &ct1->c[1], 36, to_ZZ("1464600685")); poly_set_coeff(cipher, &ct1->c[1], 37, to_ZZ("2202350226")); poly_set_coeff(cipher, &ct1->c[1], 38, to_ZZ("85070591728741592497072111197289851720")); poly_set_coeff(cipher, &ct1->c[1], 39, to_ZZ("1075513330")); poly_set_coeff(cipher, &ct1->c[1], 40, to_ZZ("3230188673")); poly_set_coeff(cipher, &ct1->c[1], 41, to_ZZ("8304037864")); poly_set_coeff(cipher, &ct1->c[1], 42, to_ZZ("12033826499")); poly_set_coeff(cipher, &ct1->c[1], 43, to_ZZ("9025529358")); poly_set_coeff(cipher, &ct1->c[1], 44, to_ZZ("11140504976")); poly_set_coeff(cipher, &ct1->c[1], 45, to_ZZ("19382016805")); poly_set_coeff(cipher, &ct1->c[1], 46, to_ZZ("10942926105")); poly_set_coeff(cipher, &ct1->c[1], 47, to_ZZ("14600568459")); poly_set_coeff(cipher, &ct1->c[1], 48, to_ZZ("13838128189")); poly_set_coeff(cipher, &ct1->c[1], 49, to_ZZ("18388172490")); poly_set_coeff(cipher, &ct1->c[1], 50, to_ZZ("27384639749")); poly_set_coeff(cipher, &ct1->c[1], 51, to_ZZ("21001910386")); poly_set_coeff(cipher, &ct1->c[1], 52, to_ZZ("16899205049")); poly_set_coeff(cipher, &ct1->c[1], 53, to_ZZ("21290013392")); poly_set_coeff(cipher, &ct1->c[1], 54, to_ZZ("21062326380")); poly_set_coeff(cipher, &ct1->c[1], 55, to_ZZ("21242658238")); poly_set_coeff(cipher, &ct1->c[1], 56, to_ZZ("20455421047")); poly_set_coeff(cipher, &ct1->c[1], 57, to_ZZ("25469751022")); poly_set_coeff(cipher, &ct1->c[1], 58, to_ZZ("25944294764")); poly_set_coeff(cipher, &ct1->c[1], 59, to_ZZ("27581632435")); poly_set_coeff(cipher, &ct1->c[1], 60, to_ZZ("26310937826")); poly_set_coeff(cipher, &ct1->c[1], 61, to_ZZ("29330340411")); poly_set_coeff(cipher, &ct1->c[1], 62, to_ZZ("31768749846")); poly_set_coeff(cipher, &ct1->c[1], 63, to_ZZ("34121496807"));
  //poly_set_coeff(cipher, &ct2->c[0], 0, to_ZZ("121319790442")); poly_set_coeff(cipher, &ct2->c[0], 1, to_ZZ("162491680764")); poly_set_coeff(cipher, &ct2->c[0], 2, to_ZZ("167395701153")); poly_set_coeff(cipher, &ct2->c[0], 3, to_ZZ("227273375586")); poly_set_coeff(cipher, &ct2->c[0], 4, to_ZZ("240215608003")); poly_set_coeff(cipher, &ct2->c[0], 5, to_ZZ("256498048816")); poly_set_coeff(cipher, &ct2->c[0], 6, to_ZZ("297116544163")); poly_set_coeff(cipher, &ct2->c[0], 7, to_ZZ("319444680438")); poly_set_coeff(cipher, &ct2->c[0], 8, to_ZZ("363223740269")); poly_set_coeff(cipher, &ct2->c[0], 9, to_ZZ("384186674395")); poly_set_coeff(cipher, &ct2->c[0], 10, to_ZZ("396227587144")); poly_set_coeff(cipher, &ct2->c[0], 11, to_ZZ("440356911485")); poly_set_coeff(cipher, &ct2->c[0], 12, to_ZZ("469269222019")); poly_set_coeff(cipher, &ct2->c[0], 13, to_ZZ("490341492153")); poly_set_coeff(cipher, &ct2->c[0], 14, to_ZZ("512219530667")); poly_set_coeff(cipher, &ct2->c[0], 15, to_ZZ("513980556530")); poly_set_coeff(cipher, &ct2->c[0], 16, to_ZZ("537478901580")); poly_set_coeff(cipher, &ct2->c[0], 17, to_ZZ("573466470799")); poly_set_coeff(cipher, &ct2->c[0], 18, to_ZZ("573188830573")); poly_set_coeff(cipher, &ct2->c[0], 19, to_ZZ("592296175766")); poly_set_coeff(cipher, &ct2->c[0], 20, to_ZZ("592199255716")); poly_set_coeff(cipher, &ct2->c[0], 21, to_ZZ("612295292415")); poly_set_coeff(cipher, &ct2->c[0], 22, to_ZZ("646052914528")); poly_set_coeff(cipher, &ct2->c[0], 23, to_ZZ("626724720864")); poly_set_coeff(cipher, &ct2->c[0], 24, to_ZZ("657915566671")); poly_set_coeff(cipher, &ct2->c[0], 25, to_ZZ("661687787691")); poly_set_coeff(cipher, &ct2->c[0], 26, to_ZZ("658777514368")); poly_set_coeff(cipher, &ct2->c[0], 27, to_ZZ("673458910444")); poly_set_coeff(cipher, &ct2->c[0], 28, to_ZZ("666609262390")); poly_set_coeff(cipher, &ct2->c[0], 29, to_ZZ("658401864001")); poly_set_coeff(cipher, &ct2->c[0], 30, to_ZZ("653178816084")); poly_set_coeff(cipher, &ct2->c[0], 31, to_ZZ("679220476835")); poly_set_coeff(cipher, &ct2->c[0], 32, to_ZZ("650336710622")); poly_set_coeff(cipher, &ct2->c[0], 33, to_ZZ("644014341361")); poly_set_coeff(cipher, &ct2->c[0], 34, to_ZZ("654288825976")); poly_set_coeff(cipher, &ct2->c[0], 35, to_ZZ("639520043601")); poly_set_coeff(cipher, &ct2->c[0], 36, to_ZZ("628699112181")); poly_set_coeff(cipher, &ct2->c[0], 37, to_ZZ("592362288931")); poly_set_coeff(cipher, &ct2->c[0], 38, to_ZZ("591098159059")); poly_set_coeff(cipher, &ct2->c[0], 39, to_ZZ("578922727947")); poly_set_coeff(cipher, &ct2->c[0], 40, to_ZZ("547527820479")); poly_set_coeff(cipher, &ct2->c[0], 41, to_ZZ("535574868791")); poly_set_coeff(cipher, &ct2->c[0], 42, to_ZZ("519967920966")); poly_set_coeff(cipher, &ct2->c[0], 43, to_ZZ("515228029534")); poly_set_coeff(cipher, &ct2->c[0], 44, to_ZZ("509120223858")); poly_set_coeff(cipher, &ct2->c[0], 45, to_ZZ("450913346097")); poly_set_coeff(cipher, &ct2->c[0], 46, to_ZZ("417173001373")); poly_set_coeff(cipher, &ct2->c[0], 47, to_ZZ("424874405293")); poly_set_coeff(cipher, &ct2->c[0], 48, to_ZZ("372277482140")); poly_set_coeff(cipher, &ct2->c[0], 49, to_ZZ("348952361606")); poly_set_coeff(cipher, &ct2->c[0], 50, to_ZZ("320001972181")); poly_set_coeff(cipher, &ct2->c[0], 51, to_ZZ("271161260287")); poly_set_coeff(cipher, &ct2->c[0], 52, to_ZZ("258616072960")); poly_set_coeff(cipher, &ct2->c[0], 53, to_ZZ("229324072270")); poly_set_coeff(cipher, &ct2->c[0], 54, to_ZZ("211707142842")); poly_set_coeff(cipher, &ct2->c[0], 55, to_ZZ("188692159279")); poly_set_coeff(cipher, &ct2->c[0], 56, to_ZZ("157943921692")); poly_set_coeff(cipher, &ct2->c[0], 57, to_ZZ("153221685174")); poly_set_coeff(cipher, &ct2->c[0], 58, to_ZZ("120589810144")); poly_set_coeff(cipher, &ct2->c[0], 59, to_ZZ("82193301704")); poly_set_coeff(cipher, &ct2->c[0], 60, to_ZZ("40371024334")); poly_set_coeff(cipher, &ct2->c[0], 61, to_ZZ("18396927799")); poly_set_coeff(cipher, &ct2->c[0], 62, to_ZZ("85070591728741592497072111174558440403")); poly_set_coeff(cipher, &ct2->c[0], 63, to_ZZ("85070591728741592497072111115841217404"));
  //poly_set_coeff(cipher, &ct2->c[1], 0, to_ZZ("85070591728741592497072111159677886062")); poly_set_coeff(cipher, &ct2->c[1], 1, to_ZZ("85070591728741592497072111160410983928")); poly_set_coeff(cipher, &ct2->c[1], 2, to_ZZ("85070591728741592497072111160848322463")); poly_set_coeff(cipher, &ct2->c[1], 3, to_ZZ("85070591728741592497072111162040771767")); poly_set_coeff(cipher, &ct2->c[1], 4, to_ZZ("85070591728741592497072111164716892428")); poly_set_coeff(cipher, &ct2->c[1], 5, to_ZZ("85070591728741592497072111160931984017")); poly_set_coeff(cipher, &ct2->c[1], 6, to_ZZ("85070591728741592497072111165216845610")); poly_set_coeff(cipher, &ct2->c[1], 7, to_ZZ("85070591728741592497072111164649758049")); poly_set_coeff(cipher, &ct2->c[1], 8, to_ZZ("85070591728741592497072111168420155426")); poly_set_coeff(cipher, &ct2->c[1], 9, to_ZZ("85070591728741592497072111167926447224")); poly_set_coeff(cipher, &ct2->c[1], 10, to_ZZ("85070591728741592497072111169499202110")); poly_set_coeff(cipher, &ct2->c[1], 11, to_ZZ("85070591728741592497072111171306164434")); poly_set_coeff(cipher, &ct2->c[1], 12, to_ZZ("85070591728741592497072111172070722954")); poly_set_coeff(cipher, &ct2->c[1], 13, to_ZZ("85070591728741592497072111179939356436")); poly_set_coeff(cipher, &ct2->c[1], 14, to_ZZ("85070591728741592497072111179387434557")); poly_set_coeff(cipher, &ct2->c[1], 15, to_ZZ("85070591728741592497072111175847120348")); poly_set_coeff(cipher, &ct2->c[1], 16, to_ZZ("85070591728741592497072111179704196051")); poly_set_coeff(cipher, &ct2->c[1], 17, to_ZZ("85070591728741592497072111175954942290")); poly_set_coeff(cipher, &ct2->c[1], 18, to_ZZ("85070591728741592497072111183434752300")); poly_set_coeff(cipher, &ct2->c[1], 19, to_ZZ("85070591728741592497072111183698421992")); poly_set_coeff(cipher, &ct2->c[1], 20, to_ZZ("85070591728741592497072111183272429323")); poly_set_coeff(cipher, &ct2->c[1], 21, to_ZZ("85070591728741592497072111186247675075")); poly_set_coeff(cipher, &ct2->c[1], 22, to_ZZ("85070591728741592497072111188455680787")); poly_set_coeff(cipher, &ct2->c[1], 23, to_ZZ("85070591728741592497072111189761363186")); poly_set_coeff(cipher, &ct2->c[1], 24, to_ZZ("85070591728741592497072111189291599482")); poly_set_coeff(cipher, &ct2->c[1], 25, to_ZZ("85070591728741592497072111185787900526")); poly_set_coeff(cipher, &ct2->c[1], 26, to_ZZ("85070591728741592497072111194641413135")); poly_set_coeff(cipher, &ct2->c[1], 27, to_ZZ("85070591728741592497072111190203677098")); poly_set_coeff(cipher, &ct2->c[1], 28, to_ZZ("85070591728741592497072111192584328577")); poly_set_coeff(cipher, &ct2->c[1], 29, to_ZZ("85070591728741592497072111192577532416")); poly_set_coeff(cipher, &ct2->c[1], 30, to_ZZ("1541004180")); poly_set_coeff(cipher, &ct2->c[1], 31, to_ZZ("85070591728741592497072111194914074881")); poly_set_coeff(cipher, &ct2->c[1], 32, to_ZZ("588303531")); poly_set_coeff(cipher, &ct2->c[1], 33, to_ZZ("1275909860")); poly_set_coeff(cipher, &ct2->c[1], 34, to_ZZ("6142320128")); poly_set_coeff(cipher, &ct2->c[1], 35, to_ZZ("5337413227")); poly_set_coeff(cipher, &ct2->c[1], 36, to_ZZ("9154338749")); poly_set_coeff(cipher, &ct2->c[1], 37, to_ZZ("11047502429")); poly_set_coeff(cipher, &ct2->c[1], 38, to_ZZ("11345769253")); poly_set_coeff(cipher, &ct2->c[1], 39, to_ZZ("11522424243")); poly_set_coeff(cipher, &ct2->c[1], 40, to_ZZ("12370580585")); poly_set_coeff(cipher, &ct2->c[1], 41, to_ZZ("11308750923")); poly_set_coeff(cipher, &ct2->c[1], 42, to_ZZ("7816641368")); poly_set_coeff(cipher, &ct2->c[1], 43, to_ZZ("10553555855")); poly_set_coeff(cipher, &ct2->c[1], 44, to_ZZ("16111796608")); poly_set_coeff(cipher, &ct2->c[1], 45, to_ZZ("21212937522")); poly_set_coeff(cipher, &ct2->c[1], 46, to_ZZ("22717765451")); poly_set_coeff(cipher, &ct2->c[1], 47, to_ZZ("19248280108")); poly_set_coeff(cipher, &ct2->c[1], 48, to_ZZ("28483977719")); poly_set_coeff(cipher, &ct2->c[1], 49, to_ZZ("26253992467")); poly_set_coeff(cipher, &ct2->c[1], 50, to_ZZ("28651662107")); poly_set_coeff(cipher, &ct2->c[1], 51, to_ZZ("28941061156")); poly_set_coeff(cipher, &ct2->c[1], 52, to_ZZ("23637914155")); poly_set_coeff(cipher, &ct2->c[1], 53, to_ZZ("30861277261")); poly_set_coeff(cipher, &ct2->c[1], 54, to_ZZ("29767044851")); poly_set_coeff(cipher, &ct2->c[1], 55, to_ZZ("22247668629")); poly_set_coeff(cipher, &ct2->c[1], 56, to_ZZ("32854806314")); poly_set_coeff(cipher, &ct2->c[1], 57, to_ZZ("30447167880")); poly_set_coeff(cipher, &ct2->c[1], 58, to_ZZ("29862090524")); poly_set_coeff(cipher, &ct2->c[1], 59, to_ZZ("30780548168")); poly_set_coeff(cipher, &ct2->c[1], 60, to_ZZ("33083720850")); poly_set_coeff(cipher, &ct2->c[1], 61, to_ZZ("31991574991")); poly_set_coeff(cipher, &ct2->c[1], 62, to_ZZ("36198264596")); poly_set_coeff(cipher, &ct2->c[1], 63, to_ZZ("40684995991"));

  // for(int i = 0; i < CUDAEngine::RNSPrimes.size(); i++)
  //   std::cout << "ct1c0" << i << " = \"" << poly_to_string(cipher, &ct1->c[0]) << "\"" << std::endl;
  // for(int i = 0; i < CUDAEngine::RNSPrimes.size(); i++)
  //   std::cout << "ct2c0" << i << " = \"" << poly_to_string(cipher, &ct2->c[0]) << "\"" << std::endl;

  fv_mul(cipher, ct3, ct1, ct2);

  /////////////
  // Decrypt //
  /////////////
  
  poly_t *m3 = fv_decrypt(cipher, ct3, sk);

  std::cout << "Input A: " << poly_to_string(cipher, &m1) << std::endl;
  std::cout << "Input B: " << poly_to_string(cipher, &m2) << std::endl;
  std::cout << "Recovered: " << poly_to_string(cipher, m3) << std::endl;
  
  /////////////
  
  poly_free(cipher, &m1);
  poly_free(cipher, &m2);
  poly_free(cipher, m3);
  cipher_free(cipher, ct1);
  cipher_free(cipher, ct2);
  cipher_free(cipher, ct3);
  delete ct1;
  delete ct2;
  delete ct3;
  delete cipher;
  CUDAEngine::destroy();
  cudaDeviceReset();
  cudaCheckError();
  return 0;
}
